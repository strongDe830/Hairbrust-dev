(()=>{"use strict";var e={"./_build/scripts/theme/helpers.js":(e,t,s)=>{function i(){document.body.style.overflowY="hidden"}function r(){document.body.style.removeProperty("overflow")}function n(e){const t=e.includes("&")?e.split("&")[0]:e,s=document.querySelector('[type="application/ld+json"]'),i=s.innerHTML;let[r,n]=i.split('"@id": "');n=n.split(n.split('"')[0])[1],s.innerHTML=`${r}"@id": "${t}${n}`;document.querySelector('[rel="canonical"]').href=theme.url+t}s.r(t),s.d(t,{debounce:()=>o,lockScrolling:()=>i,unlockScrolling:()=>r,updateCanonicalLinks:()=>n});const o=(e,t)=>{let s;return function(...i){s&&clearTimeout(s),s=setTimeout((()=>{e(...i)}),t)}}}},t={};function s(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{s.r(i);var e=s("./_build/scripts/theme/helpers.js");class t extends HTMLElement{constructor(){super(),this.input=this.querySelector('input[type="search"]'),this.resetButton=this.querySelector('button[type="reset"]'),this.submitButton=this.querySelector('button[type="submit"]'),this.overlay=document.querySelector("[data-predictive-search-overlay]"),this.wrapper=document.querySelector("[data-predictive-search-wrapper]"),this.closeBtn=document.querySelector("[data-predictive-search-close-btn]"),this.classes={hidden:"hidden",visible:"is-visible",active:"js-is-active",open:"is-open",searchVisible:"js-search-visible"},this.input&&(this.input.form.addEventListener("reset",this.onFormReset.bind(this)),this.input.addEventListener("input",(0,e.debounce)((e=>{this.onChange(e)}),300).bind(this))),this.closeBtn&&this.closeBtn.addEventListener("click",this.closePredictiveSearch.bind(this))}closePredictiveSearch(){document.body.classList.remove(this.classes.searchVisible),window.setOverlay(),window.unlockScrolling()}toggleResetButton(){this.input.value.length>0?this.resetButton.hidden=!1:0===this.input.value.length&&(this.resetButton.hidden=!0)}toggleSubmitButton(){this.input.value.length>0?this.submitButton.classList.add(this.classes.active):0===this.input.value.length&&this.submitButton.classList.remove(this.classes.active)}onChange(){this.toggleResetButton(),this.toggleSubmitButton()}shouldResetForm(){return!document.querySelector('[aria-selected="true"] a')}onFormReset(e){e.preventDefault(),this.shouldResetForm()&&(this.input.value="",this.input.focus(),this.toggleResetButton(),this.toggleSubmitButton(),this.loadSuggestedResults())}}customElements.define("search-form",t);customElements.define("predictive-search",class extends t{constructor(){super(),this.cachedResults={},this.predictiveSearchResults=this.querySelector("[data-predictive-search]"),this.allPredictiveSearchInstances=document.querySelectorAll("predictive-search"),this.searchWrapper=document.querySelector("[data-predictive-search-wrapper]"),this.suggestedContentEnabled=this.searchWrapper.dataset.predictiveSearchSuggestedContentEnabled,this.resourceTypes=this.searchWrapper.dataset.predictiveSearchTypes,this.resourceLimitEach=this.searchWrapper.dataset.predictiveSearchLimitEach,this.resourceLimitAll=this.searchWrapper.dataset.predictiveSearchLimitAll,this.showUnavailable=this.searchWrapper.dataset.predictiveSearchShowUnavailable,this.rootUrl=this.searchWrapper.dataset.routesRootUrl,this.predictiveSearchUrl=this.searchWrapper.dataset.routesPredictiveSearchUrl,this.searchToggle=document.querySelector('[data-site-header-el="searchToggleBtn"]'),this.isOpen=!1,this.abortController=new AbortController,this.searchTerm="",this.setupEventListeners()}setupEventListeners(){this.addEventListener("focusout",this.onFocusOut.bind(this)),this.addEventListener("keyup",this.onKeyup.bind(this)),this.addEventListener("keydown",this.onKeydown.bind(this)),this.input&&(this.input.form.addEventListener("submit",this.onFormSubmit.bind(this)),this.input.addEventListener("focus",this.onFocus.bind(this))),this.loadSuggestedResults()}loadSuggestedResults(){if("true"===theme.search.suggested_content_enabled){const e=this.getSearchResults.bind(this),t=this.open.bind(this);function s(s){e(null),t()}function i(e){this.input.removeEventListener("click",s),this.searchToggle.removeEventListener("click",s),this.input.removeEventListener("change",i.bind(this))}this.input.addEventListener("click",s),this.searchToggle.addEventListener("click",s),this.input.addEventListener("change",i.bind(this))}}getQuery(){return this.input.value.trim()}onClickSearchOpen(){this.wrapper.classList.add(this.classes.visible)}onClickSearchClose(){this.wrapper.classList.remove(this.classes.visible)}onChange(){super.onChange();const e=this.getQuery();this.searchTerm&&e.startsWith(this.searchTerm)||this.querySelector("#predictive-search-results-groups-wrapper")?.remove(),this.searchTerm=e,this.searchTerm.length?this.getSearchResults(this.searchTerm):this.close(!0)}onFormSubmit(e){this.getQuery().length&&!this.querySelector('[aria-selected="true"] a')||e.preventDefault()}onFormReset(e){super.onFormReset(e),super.shouldResetForm()&&(this.searchTerm="",this.abortController.abort(),this.abortController=new AbortController,this.closeResults(!0))}onFocus(){const e=this.getQuery();(e.length||0!==this.searchTerm.length)&&(this.searchTerm!==e?this.onChange():"true"===this.getAttribute("results")?this.open():this.getSearchResults(this.searchTerm))}onFocusOut(){setTimeout((()=>{this.contains(document.activeElement)||this.classList.contains(this.classes.open)||this.close()}))}onKeyup(e){switch(this.getQuery().length||this.close(!0),e.preventDefault(),e.code){case"ArrowUp":this.switchOption("up");break;case"ArrowDown":this.switchOption("down");break;case"Enter":this.selectOption()}}onKeydown(e){"ArrowUp"!==e.code&&"ArrowDown"!==e.code||e.preventDefault()}updateSearchForTerm(e,t){const s=this.querySelector("[data-predictive-search-search-for-text]"),i=s?.innerText;if(i){if(i.match(new RegExp(e,"g")).length>1)return;const r=i.replace(e,t);s.innerText=r}}switchOption(e){if(!this.getAttribute("open"))return;const t="up"===e,s=this.querySelector('[aria-selected="true"]'),i=Array.from(this.querySelectorAll("li, button.predictive-search__item")).filter((e=>null!==e.offsetParent));let r=0;if(t&&!s)return;let n=-1,o=0;for(;-1===n&&o<=i.length;)i[o]===s&&(n=o),o++;if(this.statusElement.textContent="",!t&&s?r=n===i.length-1?0:n+1:t&&(r=0===n?i.length-1:n-1),r===n)return;const a=i[r];a.setAttribute("aria-selected",!0),s&&s.setAttribute("aria-selected",!1),this.input.setAttribute("aria-activedescendant",a.id)}selectOption(){const e=this.querySelector('[aria-selected="true"] a, button[aria-selected="true"]');e&&e.click()}getSearchResults(e){if(document.querySelector("[data-close-search-modal]")?.remove(),null!==e){const t=e.replace(" ","-").toLowerCase();if(this.setLiveRegionLoadingState(),this.cachedResults[t])return void this.renderSearchResults(this.cachedResults[t]);const s=`resources[type]=${this.resourceTypes}&resources[limit]=${this.resourceLimitEach}`+("true"===this.resourceLimitAll?"":"&resources[limit_scope]=each")+`&resources[options][unavailable_products]=${this.showUnavailable}&resources[options][fields]=title,product_type,tag,variants.title,variants.sku,variants.barcode,vendor`;window.searchString=s,fetch(`${this.predictiveSearchUrl}?q=${encodeURIComponent(e)}&${s}&section_id=predictive-search`,{signal:this.abortController.signal}).then((async e=>{if(!e.ok){const s=await e.text();var t=new Error(e.status+" "+s);throw this.close(),t}return e.text()})).then((e=>{const s=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.allPredictiveSearchInstances.forEach((e=>{e.cachedResults[t]=s})),this.renderSearchResults(s)})).catch((e=>{if(20!==e?.code)throw this.close(),e}))}else{if(this.setLiveRegionLoadingState(),this.cachedResults["predictive-search-default-suggestions"])return void this.renderSearchResults(this.cachedResults["predictive-search-default-suggestions"]);fetch(`${this.rootUrl}?section_id=predictive-search`,{signal:this.abortController.signal}).then((async e=>{if(!e.ok){const s=await e.text();var t=new Error(e.status+" "+s);throw this.close(),t}return e.text()})).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.renderSearchResults(t),this.allPredictiveSearchInstances.forEach((e=>{e.cachedResults["predictive-search-default-suggestions"]=t}))})).catch((e=>{if(20!==e?.code)throw this.close(),e}))}}setLiveRegionLoadingState(){this.statusElement=this.statusElement||this.querySelector(".predictive-search-status"),this.loadingText=this.loadingText||this.getAttribute("data-loading-text"),this.setLiveRegionText(this.loadingText),this.setAttribute("loading",!0)}setLiveRegionText(e){this.statusElement.setAttribute("aria-hidden","false"),this.statusElement.textContent=e,setTimeout((()=>{this.statusElement.setAttribute("aria-hidden","true")}),1e3)}renderSearchResults(e){this.predictiveSearchResults.innerHTML=e,this.setAttribute("results",!0),this.setLiveRegionResults(),this.open()}setLiveRegionResults(){this.removeAttribute("loading");const e=this.querySelector("[data-predictive-search-live-region-count-value]");e&&e.textContent&&this.setLiveRegionText(e.textContent)}getResultsMaxHeight(){return this.resultsMaxHeight=window.innerHeight-document.querySelector("site-header").getBoundingClientRect().bottom,this.resultsMaxHeight}open(){this.setAttribute("open",!0),this.input.setAttribute("aria-expanded",!0),this.isOpen=!0}close(e=!1){this.closeResults(e),this.isOpen=!1,document.body.style.overflowY=null}closeResults(e=!1){e&&(this.input.value="",this.removeAttribute("results"));const t=this.querySelector('[aria-selected="true"]');t&&t.setAttribute("aria-selected",!1),this.input.setAttribute("aria-activedescendant",""),this.removeAttribute("loading"),this.removeAttribute("open"),this.input.setAttribute("aria-expanded",!1),this.resultsMaxHeight=!1,this.predictiveSearchResults.removeAttribute("style")}})})()})();