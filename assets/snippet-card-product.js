customElements.get("card-product")||customElements.define("card-product",class extends HTMLElement{constructor(){super(),this.form=this.querySelector("form"),this.form&&(this.submitButton=this.form.querySelector("[data-product-add-to-cart]"),this.submitButton.addEventListener("click",this.onSubmitHandler.bind(this)))}async onSubmitHandler(t){t.preventDefault(),t.stopPropagation();const e=new FormData(this.form),r=Number(e.get("id")),i=function(t){const e=[...t.entries()].filter((([t,e])=>t.includes("properties[")&&""!==e));function r(t,[e,r]){const i=e.replace("properties[","").slice(0,-1);return{...t,[i]:r}}return e.reduce(r,{})}(e),n=Number(e.get("selling_plan"))>0?Number(e.get("selling_plan")):null,o=!!this.querySelector("[data-bogo-enabled]"),s=Number(this.querySelector("[data-free-gift-id]")?.dataset.freeGiftId);if(s)if(o){const t=[{id:r,quantity:2,properties:i},{id:s,quantity:1,properties:{}}];await this.addMultiple(t)}else{const t=[{id:r,properties:i,selling_plan:n},{id:s,quantity:1,properties:{},selling_plan:null}];await this.addMultiple(t)}else await this.addToCart({id:r,properties:i,sellingPlan:n},o)}async addToCart(t,e){let r=1;e&&(r=2);try{return window.Herd.Cart.addItem({id:t.id,quantity:r,properties:t.properties,sellingPlan:t.sellingPlan},this.form,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((t=>t.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(e){return this.handleAddToCartError(e,t)}}async addMultiple(t){try{return window.Herd.Cart.addItems(t,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((t=>t.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(e){return this.handleAddToCartError(e,t)}}async handleAddToCartError(t,e){}});