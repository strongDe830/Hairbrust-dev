(()=>{function e(e){return[...e.entries()].filter((([e,t])=>e.includes("properties[")&&""!==t)).reduce((function(e,[t,r]){const a=t.replace("properties[","").slice(0,-1);return{...e,[a]:r}}),{})}customElements.get("card-subscription-product")||customElements.define("card-subscription-product",class extends HTMLElement{constructor(){super(),this.initSubscriptionVariantDropdown(),this.form=this.querySelector("form"),this.form&&this.form.addEventListener("submit",this.onSubmitHandler.bind(this))}initSubscriptionVariantDropdown(){const e=this.querySelector("[data-hidden-variant-id]"),t=this.querySelector("[data-sub-option-open]"),r=this.querySelector("[data-sub-option-list]");t&&r&&(t.addEventListener("click",(()=>{r.classList.toggle("hidden")})),Array.from(r.children).forEach((a=>{a.addEventListener("click",(()=>{r.classList.add("hidden"),t.querySelector("[data-selected-current]").innerHTML=a.querySelector("[data-variant-current]").innerHTML,t.querySelector("[data-selected-was]").innerHTML=a.querySelector("[data-variant-was]").innerHTML,t.querySelector("[data-selected-title]").innerHTML=a.querySelector("[data-variant-title]").innerHTML,t.querySelector("[data-selected-tagline]").innerHTML=a.querySelector("[data-variant-tagline]").innerHTML,a.querySelector("[data-variant-info]")?t.querySelector("[data-selected-info]").innerHTML=a.querySelector("[data-variant-info]").innerHTML:t.querySelector("[data-selected-info]").innerHTML="",""==a.querySelector("[data-variant-tagline]").innerHTML.trim()?t.querySelector("[data-selected-tagline]").classList.add("hidden"):t.querySelector("[data-selected-tagline]").classList.remove("hidden"),a.querySelector("[data-variant-info]")&&""!=a.querySelector("[data-variant-info]").innerHTML.trim()?t.querySelector("[data-selected-info]").classList.remove("hidden"):t.querySelector("[data-selected-info]").classList.add("hidden"),""==a.querySelector("[data-variant-savings]").innerHTML.trim()?t.querySelector("[data-selected-savings]").classList.add("hidden"):(t.querySelector("[data-selected-savings]").classList.remove("hidden"),t.querySelector("[data-selected-savings]").innerHTML=a.querySelector("[data-variant-savings]").innerHTML);const i=this.querySelector('[name="selling_plan"]'),n=a.getAttribute("data-selling-plan-id");null!=n?(i.removeAttribute("hidden"),i.value=n):(i.value="",i.hidden=!0),Array.from(r.children).forEach((e=>{e.classList.remove("active")})),a.classList.add("active"),e.value=a.dataset.variantId}))})))}async onSubmitHandler(t){t.preventDefault();const r=new FormData(t.target),a=Number(r.get("id"));let i=e(new FormData);const n=Number(r.get("selling_plan"))>0?Number(r.get("selling_plan")):null,s=Array.from(this.querySelector("[data-sub-option-list]").children).filter((e=>e.dataset.variantId==a))[0],d=!!s.querySelector("[data-bogo-enabled]");if(d&&(i=e(r)),s.dataset.freeGiftId){const e=Number(s.dataset.freeGiftId);if(d){const t=[{id:a,quantity:2,properties:i},{id:e,quantity:1,properties:{}}];await this.addMultiple(t)}else{const t=[{id:a,properties:i,selling_plan:n},{id:e,quantity:1,properties:{},selling_plan:null}];await this.addMultiple(t)}}else await this.addToCart({id:a,properties:i,sellingPlan:n},d)}async addToCart(e,t){let r=1;t&&(r=2);try{return window.Herd.Cart.addItem({id:e.id,quantity:r,properties:e.properties,sellingPlan:e.sellingPlan},this.form,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((e=>e.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(t){return this.handleAddToCartError(t,e)}}async addMultiple(e){try{return window.Herd.Cart.addItems(e,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((e=>e.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(t){return this.handleAddToCartError(t,e)}}async handleAddToCartError(e,t){console.log(e,t)}})})();