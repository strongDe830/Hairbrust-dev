customElements.get("cart-line-item")||customElements.define("cart-line-item",class extends(window.Herd.SparkElement()){_loading=!1;sections=window.Herd.utils.sectionRenderer.popoutCartSections;setupListeners(){super.setupListeners(),this.initSubscriptionSelector(),this.removeLineItem=this.removeLineItem.bind(this),this.updateQuantity=this.updateQuantity.bind(this),this.els?.remove&&this.els?.remove.exists&&this.listeners.add(this.els.remove.element,"click",this.removeLineItem),this.els?.quantity.exists&&this.els.quantity.elements.forEach((t=>{this.listeners.add(t,"change",this.updateQuantity)}))}async removeLineItem(t){try{t&&t.preventDefault(),this.setAttribute("aria-busy","true");const e=await window.Herd.Cart.removeItem(this.dataKey);"sections"in e&&this.renderSections(e.sections)}catch(t){}finally{this.removeAttribute("aria-busy")}}async updateQuantity(t){try{const e=parseInt(t.currentTarget.value,10);if(isNaN(e)||e<0)throw new Error("Invalid quantity input");this.setAttribute("aria-busy","true");const i=await window.Herd.Cart.updateQuantity(this.dataKey,e);"sections"in i&&this.renderSections(i.sections)}catch(t){}finally{this.removeAttribute("aria-busy")}}async changeVariant(t,e,i,s=!1,n=null){const a={id:t,quantity:e,properties:i,sellingPlanId:n};let r=null;try{r=await window.Herd.Cart.addItem({id:a.id,quantity:a.quantity,properties:a.properties,sellingPlan:a.sellingPlanId},null,{sections:[],sectionsUrl:window.location.pathname+window.location.search})}catch(t){r=this.handleAddToCartError(t,a)}return s&&await this.removeLineItem(),r}async handleAddToCartError(t,e){}initSubscriptionSelector(){const t=this.querySelector("[data-subscription-selector-wrapper]");if(t){const e=this.querySelector("[data-subscription-selected]"),i=t.querySelector("[data-subscription-selector]");e.addEventListener("click",(t=>{i.classList.toggle("hidden")})),Array.from(i.children).forEach((t=>{t.addEventListener("click",(()=>{if(t.classList.contains("selected"))return;const e=this.querySelector(".c-qty").querySelector("input").value,i=t.dataset.sellingPlanId;this.changeVariant(t.dataset.subscriptionVariantId,e,{},!0,i)}))}))}}get loading(){return this._loading}set loading(t){this._loading=t}get dataKey(){return this.dataset.key}});