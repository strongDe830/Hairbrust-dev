customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){super(),this.form=this.querySelector("form"),this.form.addEventListener("submit",this.onSubmitHandler.bind(this))}async onSubmitHandler(t){t.preventDefault();const e=new FormData(t.target),i=Number(e.get("id")),r=function(t){const e=[...t.entries()].filter((([t,e])=>t.includes("properties[")&&""!==e));function i(t,[e,i]){const r=e.replace("properties[","").slice(0,-1);return{...t,[r]:i}}return e.reduce(i,{})}(e),n=Number(e.get("selling_plan"))>0?Number(e.get("selling_plan")):null;let a=Number(e.get("quantity"));const s=this.querySelector("[data-bogof]").querySelector("[data-bogo-enabled]");s&&(a=Number(e.get("quantity"))+1);const o=Number(this.querySelector(`[data-variant-id="${i}"]`)?.parentElement?.querySelector("[data-free-gift-id]")?.dataset.freeGiftId);if(o)if(s){const t=[{id:i,quantity:2,properties:r},{id:o,quantity:1,properties:{}}];await this.addMultiple(t)}else{const t=[{id:i,properties:r,selling_plan:n},{id:o,quantity:1,properties:{},selling_plan:null}];await this.addMultiple(t)}else if(s){const t=[{id:i,quantity:2,properties:r}];await this.addMultiple(t)}else await this.addToCart({id:i,properties:r,sellingPlan:n},s)}async addToCart(t){try{return Shopify.analytics.publish("rsd_atb_upsell_click",{variantid:t.id}),window.Herd.Cart.addItem({id:t.id,quantity:t.quantity,properties:t.properties,sellingPlan:t.sellingPlan},this.form,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((t=>t.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(e){return this.handleAddToCartError(e,t)}}async addMultiple(t){try{return window.Herd.Cart.addItems(t,{sections:window.Herd.utils.sectionRenderer.popoutCartSections.map((t=>t.section)),sectionsUrl:window.location.pathname+window.location.search})}catch(e){return this.handleAddToCartError(e,t)}}async handleAddToCartError(t,e){}});